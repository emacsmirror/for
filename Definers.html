<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- This manual documents For (version 0.1).

Copyright (C) 2022 Wing Hei Chan

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.3 or
any later version published by the Free Software Foundation; with no
Invariant Sections, no Front-Cover Texts, and no Back-Cover Texts.  A
copy of the license is included in the section entitled "GNU
Free Documentation License". -->
<!-- Created by GNU Texinfo 6.7, http://www.gnu.org/software/texinfo/ -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>Definers (For)</title>

<meta name="description" content="Definers (For)">
<meta name="keywords" content="Definers (For)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<link href="index.html" rel="start" title="Top">
<link href="Concept-Index.html" rel="index" title="Concept Index">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="index.html" rel="up" title="Top">
<link href="Iteration-Forms.html" rel="next" title="Iteration Forms">
<link href="Buffer_002dLocal-Variables.html" rel="prev" title="Buffer-Local Variables">
<style type="text/css">
@import url("https://www.gnu.org/software/emacs/manual.css");
cite { font-style: italic; }
</style>

</head>

<body lang="en">
<span id="Definers"></span><div class="header">
<p>
Next: <a href="Iteration-Forms.html" accesskey="n" rel="next">Iteration Forms</a>, Previous: <a href="Buffer_002dLocal-Variables.html" accesskey="p" rel="prev">Buffer-Local Variables</a>, Up: <a href="index.html" accesskey="u" rel="up">Top</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Concept-Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<hr>
<span id="Definers-1"></span><h2 class="chapter">4 Definers</h2>
<p>Two definers are available for defining sequence constructors and
special-clause operators.  This chapter specifies them.
</p>
<dl>
<dt id="index-define_002dfor_002dsequence">Macro: <strong>define-for-sequence</strong> <em><var>name</var> <var>arglist</var> [<var>docstring</var>] [<var>subform</var>&hellip;] [<var>body</var>&hellip;]</em></dt>
<dd><p>This definer defines the sequence constructor <var>name</var> as a generator
with <var>arglist</var> as the argument list, an optional <var>docstring</var> as
the documentation string, and optional <var>body</var>s as the body.  When no
<var>body</var> is present and <var>arglist</var> does not contain a <code>&amp;rest</code>
argument (see <a href="https://www.gnu.org/software/emacs/manual/html_node/elisp/Argument-List.html#Argument-List">(elisp)Argument List</a>), the default body is used.
</p>
<p>The default body is as follows where <var>args</var> is <var>arglist</var> with a
potential <code>&amp;optional</code> keyword (see <a href="https://www.gnu.org/software/emacs/manual/html_node/elisp/Argument-List.html#Argument-List">(elisp)Argument List</a>)
removed:
</p>
<div class="example">
<pre class="example">(iter-make (for-do ((value (<var>name</var> . <var>args</var>))
                    (:do (iter-yield value)))))
</pre></div>

<p>Additional properties can be associated with the sequence constructor
with optional <var>subform</var>s where a <var>subform</var> is one of the
following types:
</p>
<ul>
<li> <code>(declare [<var>declaration</var>&hellip;])</code>

</li><li> <code>(:alias [<var>alias</var>&hellip;])</code>

</li><li> <code>(:type [<var>type</var>&hellip;])</code>

</li><li> <code>(:expander (<var>arg</var>) <var>body</var>&hellip;)</code> <em>or</em>
<code>(:expander-case [<var>case</var>&hellip;])</code>
</li></ul>

<p>It is an error for a type to appear more than once.  The form of
<code>declare</code> subforms is the same as normal <code>declare</code> forms
(see <a href="https://www.gnu.org/software/emacs/manual/html_node/elisp/Declare-Form.html#Declare-Form">(elisp)Declare Form</a>).  An <var>alias</var> is an identifier as an
alias of <var>name</var> available when used in iteration clauses.  A
<var>type</var> is a symbol as a type dispatched to <var>name</var> when used in
iteration clauses.  When an <code>:expander</code> subform is present, an
expander with <var>arg</var> as the sole argument and <var>body</var>s as the body
is defined and available when used in iteration clauses.  The expander
receives the iteration clause as the argument and produces an expanded
iteration clause.  An <code>:expander-case</code> subform is equivalent to an
<code>:expander</code> subform with <code>(pcase-exhaustive <var>arg</var>
[<var>case</var>&hellip;])</code> as the sole expression in <var>body</var>.
</p>
<p>Note that the subforms are processed <em>before</em> the generator is
defined.  Therefore, the aliases and expander are available in the body
of generator.
</p></dd></dl>

<dl>
<dt id="index-define_002dfor_002dspecial_002dclause">Macro: <strong>define-for-special-clause</strong> <em><var>name</var> <var>arglist</var> [<var>docstring</var>] [<var>subform</var>&hellip;]</em></dt>
<dd><p>This definer defines the special-clause operator <var>name</var> as an
expander with an optional <var>docstring</var> as the documentation string.
It is an error for <var>name</var> to be a non-keyword.  When a special
clause <code>(<var>name</var> . <var>subforms</var>)</code> is encountered, the expander
is invoked.  The expander receives two arguments where the first is the
special clause and the second is the body expanded so far as a list of
forms, and produces the further expanded body as a list of forms.
<var>arglist</var> and <var>subform</var>s are expanded as follows:
</p>
<ul>
<li> When <var>arglist</var> has <em>two</em> identifiers, <var>arglist</var> is the
argument list of expander, and <var>subform</var>s are the body of expander;

</li><li> When <var>arglist</var> has <em>one</em> identifier <var>body</var>,
<code>(special-clause <var>body</var>)</code> is the argument list of expander, and
<code>(pcase-exhaustive special-clause
[<var>subform</var>&hellip;])</code> is the sole expression in the body
of expander.
</li></ul>

<p>It is an error for <var>arglist</var> to be in any other form.
</p></dd></dl>

<hr>
<div class="header">
<p>
Next: <a href="Iteration-Forms.html" accesskey="n" rel="next">Iteration Forms</a>, Previous: <a href="Buffer_002dLocal-Variables.html" accesskey="p" rel="prev">Buffer-Local Variables</a>, Up: <a href="index.html" accesskey="u" rel="up">Top</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Concept-Index.html" title="Index" rel="index">Index</a>]</p>
</div>



</body>
</html>
